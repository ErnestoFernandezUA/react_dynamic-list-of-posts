(this["webpackJsonpreact_dynamic-list-of-posts"]=this["webpackJsonpreact_dynamic-list-of-posts"]||[]).push([[0],[,,,,,,,,,,,,,,,function(e,t,s){},function(e,t,s){},function(e,t,s){},,function(e,t,s){},function(e,t,s){},function(e,t,s){},function(e,t,s){"use strict";s.r(t);var c=s(9),n=s.n(c),o=s(4),a=s(2),r=s(3),l=s.n(r),i=s(1),u=s.n(i),d=s(5),j=s.n(d),b=(s(15),s(16),"https://mate.academy/students-api"),m=function(){var e=Object(o.a)(l.a.mark((function e(t){var s,c,n=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.length>1&&void 0!==n[1]?n[1]:{method:"GET"},console.log("request to: ".concat(b).concat(t)),console.log("request options:",s),e.next=5,fetch("".concat(b).concat(t),s);case 5:if((c=e.sent).ok){e.next=8;break}return e.abrupt("return",Promise.reject("".concat(c.status," - ").concat(c.statusText)));case 8:return e.abrupt("return",c.json());case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e){return m("/posts/".concat(e))},O=(s(17),s(0)),h=function(){return Object(O.jsx)("div",{className:"Loader",children:Object(O.jsx)("div",{className:"Loader__content"})})},f=(s(19),function(e){var t=e.currentUserId,s=e.selectedPostId,c=e.setSelectedPostId,n=Object(i.useState)([]),r=Object(a.a)(n,2),u=r[0],d=r[1],b=Object(i.useState)(!1),p=Object(a.a)(b,2),f=p[0],x=p[1],v=function(){var e=Object(o.a)(l.a.mark((function e(){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.prev=1,e.next=4,m("All"===(c=t)?"/posts":"/posts?userId=".concat(c));case 4:s=e.sent,d(s),x(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),x(!1),console.log("error",e.t0);case 13:case"end":return e.stop()}var c}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();Object(i.useEffect)((function(){console.log("mounted",t),c(""),v(),console.log("postsList = ",u)}),[t]);return Object(O.jsxs)("div",{className:j()("PostsList",{"PostsList--empty":!t}),children:[Object(O.jsx)("h2",{children:"Posts:"}),f?Object(O.jsx)(h,{}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("p",{children:"Count posts: ".concat(u.length)}),Object(O.jsx)("ul",{className:"PostsList__list",children:u.map((function(e){return Object(O.jsxs)("li",{className:j()("PostsList__item",{"PostsList__item--active":e.id===s}),"data-cy":"postDetails",children:[Object(O.jsxs)("div",{children:[Object(O.jsx)("strong",{children:e.title}),":",Object(O.jsx)("br",{}),"".concat(e.body)]}),Object(O.jsx)("button",{type:"button",className:"PostsList__button button",onClick:function(){return function(e){switch(console.log("postId =",e),console.log("selectedPostId before = ",s),!0){case s&&e===s:c(""),console.log("postId === selectedPostId",e,s);break;case s&&e!==s:c(e),console.log("postId !== selectedPostId",e,s);break;default:c(e),console.log("selectedPostId undefined =",e,s)}console.log("selectedPostId after =",s)}(e.id)},children:s===e.id?"Close":"Open"})]},e.id)}))})]})]})}),x=function(e){return t=e,m("/comments",{method:"POST",headers:{"Content-type":"application/json; charset=utf-8"},body:JSON.stringify(t)});var t},v=function(e){return console.log("commentId = ",e),t="/comments/".concat(e),m(t,{method:"DELETE"});var t},_=s(6),P=s(8),g=(s(20),function(e){var t=e.selectedPostId,s=e.loadData,c={postId:t,name:"",email:"",body:""},n=Object(i.useState)(c),o=Object(a.a)(n,2),r=o[0],l=o[1];Object(i.useEffect)((function(){l(c)}),[t]);var u=function(e){l(Object(P.a)(Object(P.a)({},r),{},Object(_.a)({},e.target.name,e.target.value)))};return Object(O.jsxs)("form",{className:"NewCommentForm",method:"POST",onSubmit:function(e){e.preventDefault(),x(r).then((function(){return s()})),l(c)},children:["postId: ".concat(t),Object(O.jsx)("div",{className:"form-field",children:Object(O.jsx)("input",{type:"text",name:"name",placeholder:"Your name",className:"NewCommentForm__input",value:r.name,onChange:u})}),Object(O.jsx)("div",{className:"form-field",children:Object(O.jsx)("input",{type:"text",name:"email",placeholder:"Your email",className:"NewCommentForm__input",value:r.email,onChange:u})}),Object(O.jsx)("div",{className:"form-field",children:Object(O.jsx)("textarea",{name:"body",placeholder:"Type comment here",className:"NewCommentForm__input NewCommentForm__input--textarea",value:r.body,onChange:u})}),Object(O.jsx)("button",{type:"submit",className:"NewCommentForm__submit-button button",children:"Add a comment"})]})}),N=(s(21),{id:"",userId:"",title:"",body:"",createdAt:"",updatedAt:""}),y=u.a.memo((function(e){var t=e.selectedPostId,s=e.setSelectedPostId;console.log("render PostDetails");var c=Object(i.useState)([]),n=Object(a.a)(c,2),r=n[0],u=n[1],d=Object(i.useState)(N),j=Object(a.a)(d,2),b=j[0],f=j[1],x=Object(i.useState)(!0),_=Object(a.a)(x,2),P=_[0],y=_[1],I=Object(i.useState)(!1),S=Object(a.a)(I,2),w=S[0],D=S[1],C=r.length,k=function(){var e=Object(o.a)(l.a.mark((function e(){var s,c,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),console.log("selectedPostId =",t),e.prev=2,e.next=5,Promise.all([(r=t,m("/comments?postId=".concat(r))),p(t)]);case 5:s=e.sent,c=Object(a.a)(s,2),n=c[0],o=c[1],u(n),f(o),D(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),console.log("error",e.t0),D(!1);case 18:case"end":return e.stop()}var r}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}();Object(i.useEffect)((function(){t&&(console.log("mounted new comment by postId = ",t),k())}),[t]);return Object(O.jsxs)("div",{className:"PostDetails",children:[Object(O.jsx)("h2",{children:"Post details:"}),w?Object(O.jsx)(h,{}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("section",{className:"PostDetails__post",children:[Object(O.jsx)("strong",{children:"".concat(b.title)}),Object(O.jsx)("p",{children:b.body})]}),Object(O.jsxs)("section",{className:"PostDetails__comments",children:[Object(O.jsx)("button",{type:"button",className:"PostDetails__button button",onClick:function(){return y(!P)},children:P?"Hide ".concat(C," comments"):"Show comments"}),P&&Object(O.jsx)("ul",{className:"PostDetails__list","data-cy":"postList",children:r.map((function(e){return Object(O.jsxs)("li",{className:"PostDetails__list-item",children:[Object(O.jsx)("button",{type:"button",className:"PostDetails__remove-button button",formMethod:"DELETE",onClick:function(){return c=e.id,void v(c).then((function(e){console.log(e,"loadData");var c=t;s(""),s(c)}));var c},children:"X"}),Object(O.jsxs)("p",{children:[Object(O.jsx)("strong",{children:"".concat(e.name,":")}),e.body]})]},e.id)}))})]})]}),Object(O.jsx)("section",{children:Object(O.jsx)("div",{className:"PostDetails__form-wrapper",children:Object(O.jsx)(g,{selectedPostId:t,loadData:k})})})]})})),I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return m("/users".concat(e))},S=function(){var e=Object(i.useState)([]),t=Object(a.a)(e,2),s=t[0],c=t[1],n=Object(i.useState)(!1),r=Object(a.a)(n,2),u=r[0],d=r[1],b=Object(i.useState)(""),m=Object(a.a)(b,2),p=m[0],x=m[1],v=Object(i.useState)(""),_=Object(a.a)(v,2),P=_[0],g=_[1],N=function(){var e=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.prev=1,e.next=4,I();case 4:t=e.sent,c(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("error",e.t0);case 11:return e.prev=11,d(!1),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(){return e.apply(this,arguments)}}();Object(i.useEffect)((function(){N()}),[]);return Object(O.jsxs)("div",{className:"App",children:[u?Object(O.jsx)(h,{}):Object(O.jsx)("header",{className:"App__header",children:Object(O.jsxs)("label",{children:["Select a user: \xa0",Object(O.jsxs)("select",{className:"App__user-selector",defaultValue:"DEFAULT",onChange:function(e){return t=e.target.value,void x(t);var t},children:[Object(O.jsx)("option",{value:"DEFAULT",disabled:!0,children:"Choose..."}),Object(O.jsx)("option",{value:"All",children:"All users"}),s.map((function(e){return Object(O.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]})}),Object(O.jsxs)("main",{className:"App__main",children:[p&&Object(O.jsx)("div",{className:"App__sidebar",children:Object(O.jsx)(f,{currentUserId:p,selectedPostId:P,setSelectedPostId:g})}),Object(O.jsx)("div",{className:j()("App__content",{"App__content--empty":!P}),children:P&&Object(O.jsx)(y,{selectedPostId:P,setSelectedPostId:g})})]})]})};n.a.render(Object(O.jsx)(S,{}),document.getElementById("root"))}],[[22,1,2]]]);
//# sourceMappingURL=main.ef63ca7d.chunk.js.map